<!doctype html>
 <html lang="en">
 <head>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width,initial-scale=1" />
   <title>Assigning an agent — please wait</title>
   <meta name="robots" content="noindex">
   <style>
     body{font-family:system-ui,Arial,sans-serif;background:#f7fafc;color:#0f172a;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}
     .card{background:white;padding:28px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.08);max-width:620px;width:94%;text-align:center}
     h1{margin:0 0 8px;font-size:20px}
    p{margin:8px 0;color:#475569}
     .count{font-weight:700;font-size:36px;margin:12px 0}
    .small{font-size:13px;color:#64748b}
    button{background:#0f172a;color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;margin-top:12px}
     button[disabled]{opacity:0.5;cursor:not-allowed}
    .progress{height:10px;background:#e2e8f0;border-radius:999px;margin-top:12px;overflow:hidden}
     .bar{height:100%;width:0%;background:linear-gradient(90deg,#34d399,#06b6d4)}
     a { color: #0f172a; text-decoration: underline; }
   </style>
 </head>
 <body>
   <div class="card" role="main" aria-live="polite">
    <h1>Please wait — assigning an available WhatsApp agent</h1>
    <p class="small">This helps distribute chats fairly. Do not close this page.</p>
 
     <div class="count" id="count">60</div>
     <div class="progress" aria-hidden="true"><div id="bar" class="bar"></div></div>
 
     <p id="status" class="small">You will be redirected when the timer ends.</p>
 
     <button id="manual" disabled>Redirect now (disabled)</button>
 
    <p class="small" style="margin-top:10px">If auto-redirect fails, please check your network or try again later.</p>
   </div>
 
 <script>
 (() => {
   const rawNumbers = [
 "+91 95155 91386","+91 62647 73155","+91 95531 39910","+91 98455 49736","+91 95596 21592",
 "+91 87972 99573","+91 74475 12414","+91 72050 10063","+91 88868 24599","+91 70655 26867",
 "+91 87972 99573","+91 79976 91229","+91 98725 25109","+91 70324 64344","+91 97563 41055",
 "+91 99596 43565","+91 70328 34280","+91 81879 24519","+91 99061 25933","+91 81211 01473",
 "+91 72078 33627","+91 72194 71491","+91 97317 75827","+91 74475 12414","+91 90595 34361",
 "+91 99637 14003","+91 81056 43297","+91 98800 74221","+91 99453 28246","+91 89779 84497",
 "+91 88537 25420","+91 99592 80886","+91 95386 76586","+91 96234 41710","+91 88276 19768",
 "+91 89569 53616","+91 74088 28699","+91 78450 98897","+91 98618 60217","+91 86195 14717",
 "+91 89570 83939","+91 87694 82401","+91 74114 11392","+91 74783 67573","+91 89569 53616",
 "+91 99734 53996","+91 88586 37274","+91 78978 84080","+91 74088 28699","+91 89570 83939"
   ];

   function normalize(s){ return (s||"").replace(/\D+/g,''); }
   const seen = new Set();
   const numbers = [];
   for (const r of rawNumbers) {
     const d = normalize(r);
     if (d && !seen.has(d)) { seen.add(d); numbers.push(d); }
   }
 
   const TOTAL = 60;
   let remaining = TOTAL;
   const countEl = document.getElementById("count");
   const barEl = document.getElementById("bar");
   const statusEl = document.getElementById("status");
   const manualBtn = document.getElementById("manual");
 
   function updateUI(){
     countEl.textContent = remaining;
     const pct = Math.round(((TOTAL - remaining)/TOTAL)*100);
     barEl.style.width = pct + "%";
     if (remaining <= 0) {
       countEl.textContent = "0";
       barEl.style.width = "100%";
    }
   }
 
   async function performRedirect(){
     try {
       if (!Array.isArray(numbers) || numbers.length === 0) {
         statusEl.textContent = "No agent numbers configured — please contact support.";
         manualBtn.disabled = true;
         return;
       }
       statusEl.textContent = "Selecting an agent now…";
       const pick = numbers[Math.floor(Math.random()*numbers.length)];
       const safe = pick.replace(/\D+/g,'');
       if (!safe) { statusEl.textContent = "Invalid agent number — please contact support."; return; }
       setTimeout(()=> { window.location.replace("https://wa.me/" + safe); }, 600);
     } catch(e) {
       console.error(e);
       statusEl.textContent = "An error occurred — please try again.";
     }
   }
 
   manualBtn.addEventListener("click", ()=>{
     remaining = 0;
     clearInterval(timer);
     updateUI();
     manualBtn.disabled = true;
     performRedirect();
   });
 
   updateUI();
   const timer = setInterval(()=>{
     remaining--;
     updateUI();
     if (remaining <= 0) {
       clearInterval(timer);
       manualBtn.disabled = true;
       performRedirect();
     } else {
       if (remaining <= 5) manualBtn.disabled = false;
       statusEl.textContent = "Please wait — assigning an agent…";
     }
   }, 1000);
 })();
 </script>
 </body>
 </html>


